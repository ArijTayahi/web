{% extends 'base.html.twig' %}

{% block title %}Salle d'attente{% endblock %}

{% block body %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card shadow text-center">
                <div class="card-body p-5">
                    <h2 class="mb-4">ðŸª‘ Salle d'attente virtuelle</h2>
                    
                    <div class="spinner-border text-primary mb-4" role="status" style="width: 3rem; height: 3rem;">
                        <span class="visually-hidden">Chargement...</span>
                    </div>

                    <p class="lead">Veuillez patienter...</p>
                    <p class="text-muted">Le mÃ©decin va vous rejoindre dans quelques instants.</p>

                    <hr class="my-4">

                    <p><strong>MÃ©decin :</strong> Dr. {{ consultation.medecin.username }}</p>
                    <p><strong>Type :</strong> Consultation en ligne</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// VÃ©rifier toutes les 3 secondes si la consultation a dÃ©marrÃ©
setInterval(function() {
    fetch('{{ path('app_consultation_show', {id: consultation.id}) }}')
        .then(response => response.text())
        .then(html => {
            // Si le statut a changÃ©, rediriger
            if (!html.includes('EN_ATTENTE')) {
                window.location.href = '{{ path('app_consultation_show', {id: consultation.id}) }}';
            }
        });
}, 3000);
</script>
{% endblock %}